## Тема “Вычисления с помощью Numpy”
## Задание 1
import numpy as np
a = np.array([[1,2,3,3,1],[6,8,11,10,7]])
mean_a = np.mean(a,1)

## Задание 2
a_centered = np.array([a[0,0:]-mean_a[0],a[1,0:]-mean_a[1]])

## Задание 3
a_centered_sp = np.dot(a_centered[0:,0], a_centered[0:,1])
a_centered_sp_divide = a_centered_sp/len(a)

## Задание 4 (Ковариация)
m = np.cov(a)

## Тема “Работа с данными в Pandas”
## Задание 1
import pandas as pd
authors = pd.DataFrame ({
    'author_id':[1, 2, 3],
    'author_name':['Тургенев', 'Чехов', 'Островский']
}, columns=['author_id', 'author_name'])

book = pd.DataFrame ({
    'author_id':[1, 1, 1, 2, 2, 3, 3],
    'book_title':['Отцы и дети', 'Рудин', 'Дворянское гнездо', 'Толстый и тонкий', 'Дама с собачкой', 'Гроза', 'Таланты и поклонники'],
    'price':[450, 300, 350, 500, 450, 370, 290]
}, columns=['author_id', 'book_title', 'price'])

## Задание 2
authors_price = pd.merge(authors, book, how ='inner', on ='author_id')

## Задание 3
top5 = authors_price.sort_values(by='price', ascending=False).head()

## Задание 4
authors_stat = authors_price.groupby(['author_name'])['price'].agg([np.min, np.max, np.mean])

## Задание 5
authors_price.insert(loc=len(authors_price.columns), column='cover', value=['твердая', 'мягкая', 'мягкая', 'твердая', 'твердая', 'мягкая', 'мягкая'])
book_info  = pd.pivot_table(authors_price, values='price', index='author_name', columns='cover', aggfunc='sum', fill_value=0)
print(book_info, '\n')
